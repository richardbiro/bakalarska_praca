\chapter{Implementácia}

\label{kap:implementation} % id kapitoly pre prikaz ref

V tejto kapitole popíšeme implementáciu algoritmického prehľadávania potenciálnych riešení pre vybrané otvorené problémy.

\section{Magické štvorce}

\subsection{Magické štvorce druhého stupňa}

\begin{subalg} Vstupom sú navzájom rôzne kladné celé čísla $u_1, v_1, u_2, v_2 \in \mathbb{N}$. Výstupom je magický štvorec veľkosti $3 \times 3$, ktorého aspoň $7$ prvkov sú druhé mocniny prirodzených čísel. Algoritmus využije tri parametrické vzorce z vety 1.2, ktoré generujú vyhovujúce magické štvorce.
\end{subalg}

\begin{algorithmic}
\State $p \gets (u_1^2 + v_1^2)(u_2^2 + 2u_2 v_2 - v_2^2)$
\State $q \gets (u_1^2 + 2u_1 v_1 - v_1^2)(u_2^2 + v_2^2)$
\State $r \gets (- u_1^2 + 2u_1 v_1 + v_1^2)(u_2^2 + v_2^2)$
\State $s \gets (u_1^2 + v_1^2)(-u_2^2 + 2u_2 v_2 + v_2^2)$
\State $t \gets (u_1^2 + v_1^2)(u_2^2 + v_2^2)$
\IF {aspoň dva z $3t^2 - p^2 - q^2, 3t^2 - p^2 - r^2, 3t^2 - q^2 - s^2, 3t^2 - r^2 - s^2$ sú štvorce}
    \STATE \textbf{return} prvý štvorec
\ENDIF
\IF {aspoň dva z $2(r^2 + s^2), 2(q^2 + s^2), 2(p^2 + r^2), 2(p^2 + q^2)$ sú štvorce}
    \STATE \textbf{return} druhý štvorec
\ENDIF
\IF {aspoň dva z $3t^2 - p^2 - q^2, r^2 + s^2 - p^2, p^2 + q^2 - s^2, 3t^2 - r^2 - s^2$ sú štvorce}
    \STATE \textbf{return} tretí štvorec
\ENDIF
\IF {aspoň dva z $3t^2 - p^2 - r^2, q^2 + s^2 - p^2, p^2 + r^2 - s^2, 3t^2 - q^2 - s^2$ sú štvorce}
    \STATE \textbf{return} štvrtý štvorec
\ENDIF
\end{algorithmic}


\begin{subalg} Na vstupe dostaneme kladné celé číslo $x \in \mathbb{N}$. Výstupom je magický štvorec veľkosti $3 \times 3$, ktorého aspoň $7$ prvkov sú druhé mocniny prirodzených čísel. Algoritmus využije dva parametrické vzorce z vety 1.3, ktoré generujú vyhovujúce magické štvorce.
\end{subalg}

\begin{algorithmic}
\STATE $x_1 \gets 8x^8 - 49x^6 + 6x^4 - 16x^2 + 2$
\STATE $x_2 \gets 8x^8 - x^6 + 30x^4 - 40x^2 + 2$
\STATE $x_3 \gets 8x^8 - 25x^6 + 18x^4 - 28x^2 + 2$
\IF {$x_1(x^2 - 2)$ je štvorec}
    \STATE \textbf{return} prvý štvorec
\ENDIF
\IF {$x_2(x^2 - 2)$ je štvorec}
    \STATE \textbf{return} prvý štvorec
\ENDIF
\IF {$x_3(x^2 - 2)$ je štvorec}
    \STATE \textbf{return} prvý štvorec
\ENDIF
\IF {$\frac{4x^{10} - 31x^8 + 76x^6 + 76x^4 - 31x^2 + 4}{2}$ je štvorec}
    \STATE \textbf{return} druhý štvorec
\ENDIF
\IF {$\frac{4x^{10} + 17x^8 + 4x^6 + 4x^4 + 17x^2 + 4}{2}$ je štvorec}
    \STATE \textbf{return} druhý štvorec
\ENDIF
\IF {$\frac{4x^{10} + 65x^8 - 68x^6 - 68x^4 + 65x^2 + 4}{2}$ je štvorec}
    \STATE \textbf{return} druhý štvorec
\ENDIF
\end{algorithmic}

\subsection{Bimagické štvorce}

\begin{subalg} Na vstupe dostaneme kladné celé číslo $h \in \mathbb{N}$. Výstupom je bimagický štvorec veľkosti $5 \times 5$ s potenciálne zápornými prvkami.
\end{subalg}

\begin{subcode}
def ohodnot(h): \\
pre všetky navzájom rôzne kladné $a,b,c$ také, že $a^2 + b^2 + c^2 < h$ \\
pridám do asociatívneho poľa $D$ trojicu $(a,b,c)$ pre kľúč $a^2+b^2+c^2$ \\
po skončení pre každý kľúč $k$ v $D$ \\
pre každé tri trojice $(a,b,c), (d,e,f), (g,h,i)$ v D[k] \\
zostroj štvorice $(a+b-c, a-b+c, -a+b+c, -a-b-c), (d+e-f, d-e+f, -d+e+f, -d-e-f), (g+h-i,g-h+i,-g+h+i,-g-h-i)$ \\
prejdi všetky možnosti ako z každej štvorice vybrať jeden prvok (dostaneme prvky $p,q,r$) \\
rieš $(s+n+p+q+r)(s-n+p+q+r) = 4(pq + pr + qr + p^2 + q^2 + r^2)$ pre celé $s,n$ \\
pre každé riešenie dopočítaj $x = \frac{s - (p+q+r) +- n}{2}, y = s - x - (p+q+r)$ ak $x$ je celé \\
ak sú všetky vybraté čísla navzájom rôzne \\
poznač si $x,y,s$ pre dané $p,q,r$ \\
po skončení prejdi disjunktné $(p_1,q_1,r_1), (p_2,q_2,r_2), (p_3,q_3,r_3), (p_4,q_4,r_4)$ so spoločným $s$ \\
na základe magického a bimagického súčtu vyplň postupne celý štvorec \\
ak si došiel na koniec, vypíš vzniknutý štvorec
\end{subcode}

\begin{algorithmic}
\STATE $D_1 = dict()$
\STATE $D_2 = dict()$
\FORALL {$a,b,c \in \mathbb{N}; a < b < c; a^2 + b^2 + c^2 < h$}
    \STATE pridaj $(a,b,c)$ do $D_1[a^2 + b^2 + c^2]$
\ENDFOR
\FORALL {$k \in D_1$}
    \FORALL {$(a,b,c), (d,e,f), (g,h,i) \in D_1[k]$}
	  \STATE $diagonala1 \gets \{a+b-c, a-b+c, -a+b+c, -a-b-c\}$
	  \STATE $stred \gets \{d+e-f, d-e+f, -d+e+f, -d-e-f\}$
	  \STATE $diagonala2 \gets \{g+h-i,g-h+i,-g+h+i,-g-h-i\}$
          \FORALL {$p \in diagonala1, q \in stred, r \in diagonala2$}
		\STATE faktorizáciou nájdi všetky $s,n \in \mathbb{Z}$, pre ktoré platí
				\begin{equation*}
				(s+n+p+q+r)(s-n+p+q+r) = 4(pq + pr + qr + p^2 + q^2 + r^2)
				\end{equation*}
		\STATE pre každé dopočítaj $x = \frac{s - (p+q+r) \pm n}{2}, y = s - x - (p+q+r)$
		\IF {$x \in \mathbb{Z} ~\textbf{and}~ diagonala1, stred, diagonala2, \{x,y,s\}$ sú disjunktné}
			\STATE pridaj $(diagonala1.index,stred.index,diagonala2.index,x,y)$ do $D_2[s]$
		\ENDIF
	  \ENDFOR
    \ENDFOR
\ENDFOR
\FORALL {$k \in D_2$}
    \FORALL {$(p_1,q_1,r_1), (p_2,q_2,r_2), (p_3,q_3,r_3), (p_4,q_4,r_4) \in D_2[k] ??????$}
    \ENDFOR
\ENDFOR
\end{algorithmic}

\begin{subalg} Na vstupe dostaneme kladné celé číslo $h \in \mathbb{N}$. Výstupom je bimagický štvorec veľkosti $5 \times 5$.
\end{subalg}

\begin{algorithmic}
\STATE $D_1 = dict()$
\STATE $D_2 = dict()$
\FOR {$a \gets 0, h$}
	\FOR {$b \gets a+1, h$}
		\FOR {$c \gets b+1, h$}
			\STATE $s \gets a+b+c$
			\STATE $t \gets a^2+b^2+c^2$
			\STATE pridaj $(a,b,c)$ do $D_1[t]$
			\STATE pridaj $(a,b,c)$ do $D_2[(s,t)]$
		\ENDFOR
	\ENDFOR
\ENDFOR

\FORALL {$k \in D_1$}
	\FORALL {$(a,b,c), (d,e,f) \in D_1[k]$}
		\STATE $x = \frac{(a+b+c) - (d+e+f)}{2}$
		\FOR {$p \gets 0, h$}
			\FORALL {$(g,h,i) \in D_2[(a+b+c-x)+p, (a^2+b^2+c^2-x^2)+p^2]$}
				\IF {$a,b,c,d,e,f,g,h,i,x,-x,p$ sú navzájom rôzne}
					\FORALL {permutácie $(a,b,c,-x), (d,e,f,x), (g,h,i)$}
						\STATE ulož $p$ na prostredný prvok štvorca
						\STATE ulož permutácie $(a,b,c,-x)$ a $(d,e,f,x)$ na zvyšné miesta na diagonálach
						\STATE ulož permutáciu $(g,h,i)$ na druhé, tretie a štvrté miesto v poslednom riadku
						\STATE na základe magického a bimagického súčtu vyplň postupne celý štvorec
						\IF {vzniknutý štvorec je bimagický}
							\STATE \textbf{print}(stvorec)
						\ENDIF
					\ENDFOR
				\ENDIF
			\ENDFOR
		\ENDFOR
	\ENDFOR
\ENDFOR
\end{algorithmic}

\subsection{Multiplikatívne magické štvorce} 

\begin{subalg} Na vstupe dostaneme ???. Výstupom je semimultiplikatívny štvorec veľkosti $5 \times 5$ alebo $6 \times 6$, ktorý má čo najbližšie k semimagickej vlastnosti (odchylky súčtov v riadkoch a stĺpcoch sú najmenšie možné).
\end{subalg}

\begin{subcode}
???
\end{subcode}

\begin{subalg} Na vstupe dostaneme kladné celé číslo $h$. Výstupom je multiplikatívny štvorec veľkosti $6 \times 6$, ktorý má čo najbližšie k magickej vlastnosti (odchylky súčtov v riadkoch, stĺpcoch a diagonálach sú najmenšie možné) a jeho prvky nemajú vyššieho prvočíselného deliteľa ako $h$.
\end{subalg}

\begin{subcode}
def ohodnot(h): \\
ulož si všetky vzorky v štvorci veľkosti $6 \times 6$ \\
ulož si všetky kombinácie vzoriek, ktoré disjunktne vyplnia celý štvorec \\
vygeneruj náhodnú postupnosť prvočíselných vzoriek a vypočítaj ich súčin \\
ak obsahuje štvorec navzájom rôzne prvky \\
vymeň dve hodnoty vzoriek ak sa tým zmenší odchylka \\
ak nie, nahraď jednu hodnotu vzorky inou hodnotou ak sa tým zmenší odchylka \\
ak nie, posuň hodnoty vzoriek o vzdialenosť neprevyšujúcu rozpätie ak sa tým zmenší odchylka \\
ak nie a menšia odchylka doteraz nebola nájdená, vypíš štvorec s odchylkou
\end{subcode}

\begin{algorithmic}
\STATE vzorky = [všetky vzorky v štvorci veľkosti $6 \times 6$ ako 6-tice]
\STATE S = []
\FORALL {$v_1,v_2,v_3,v_4,v_5,v_6 \in vzorky$}
    \IF {$v_1,v_2,v_3,v_4,v_5,v_6$ vypĺňajú celý štvorec}
	\STATE pridaj $(v_1,v_2,v_3,v_4,v_5,v_6)$ do $S$
    \ENDIF
\ENDFOR
\STATE H = []
\STATE ???????
\end{algorithmic}

\section{Magické grafy}

\subsection{Vrcholovo bimagické grafy}
 
\begin{subalg} Na vstupe dostaneme ľubovoľný súvislý graf. Výstupom je odpoveď, či má graf šancu byť vrcholovo bimagickým. Pre každú dvojicu jeho vrcholov overíme, či spĺňa podmienku z vety 1.4. Ak existuje dvojica vrcholov, pre ktorú graf nevyhovuje niektorej z podmienok (i) - (iii), tak môžeme s istotou povedať, že nie je vrcholovo bimagický.
\end{subalg}

\begin{algorithmic}
\FOR {$v_1, v_2 \in V(G)$}
    \STATE $x \gets |\{susedia[v1]\} - \{susedia[v2]\}|$
    \STATE $y \gets |\{susedia[v2]\} - \{susedia[v1]\}|$
    \IF {$xy = 0 ~\textbf{and}~ x+y \geq 0$}
	\STATE \textbf{return} $G$ nie je vrcholovo bimagický
    \ENDIF
    \IF {$x = 1 ~\textbf{or}~ y = 1$}
	\STATE \textbf{return} $G$ nie je vrcholovo bimagický
    \ENDIF
    \IF {$x = 2 ~\textbf{and}~ y = 2$}
	\STATE \textbf{return} $G$ nie je vrcholovo bimagický
    \ENDIF
\ENDFOR
\end{algorithmic}


\begin{subalg} Na vstupe dostaneme čísla $i,j \in \mathbb{N}$. Výstupom má byť vrcholové bimagické ohodnotenie grafu $K_{i,j}$. Algoritmus bude replikovať indukčný dôkaz vety 1.5.
\end{subalg}

\begin{algorithmic}
\IF {$i > j$}
	\STATE \textbf{return} ohodnot(j,i)
\ENDIF
\IF {$i \leq 1 ~\textbf{or}~ (i = 2 ~\textbf{and}~ j = 2)$}
	\STATE \textbf{return} nedá sa ohodnotiť
\ENDIF
\IF {$i = 2$}
	\STATE \textbf{return} $(\frac{j(j-1)}{2} + 1, \frac{j(j-1)(3j^2-7j+14)}{24}), (1, ... , j-1, \frac{j(j-1)(3j^2-7j+14)}{24} + 1)$
\ENDIF
\IF {$i = 3$}
	\STATE \textbf{return} $(1, \frac{j(j+1)}{2} - 1, \frac{j(j+1)(3j^2-j-14)}{24} + 1), (2, ... , j, \frac{j(j+1)(3j^2-j-14)}{24} + 2)$
\ENDIF
\IF {$i = 4 ~\textbf{and}~ j = 4$}
	\STATE \textbf{return} $(1, 4, 6, 7), (2, 3, 5, 8)$
\ENDIF
\IF {$i = 4 ~\textbf{and}~ j = 5$}
	\STATE \textbf{return} $(2, 12, 13, 15), (1, 4, 8, 10, 19)$
\ENDIF
\STATE $H \gets$ ohodnot(i - 2, j - 3)
\STATE $m \gets$ max(H) + 1
\STATE na ľavú stranu H pridaj $4m, 5m$
\STATE na pravú stranu H pridaj $m, 2m, 6m$
\STATE \textbf{return} H
\end{algorithmic}

\begin{subalg}  Na vstupe dostaneme číslo $n \in \mathbb{N}$. Výstupom algoritmu má byť vrcholové superbimagické ohodnotenie kompletného bipartitného grafu s $n$ vrcholmi. Algoritmus bude replikovať indukčný dôkaz vety 1.9.
\end{subalg}

\begin{algorithmic}
\IF {$n < 7$}
	\STATE \textbf{return} nedá sa ohodnotiť
\ENDIF
\IF {$n ~\textbf{mod}~ 4 = 1 ~\textbf{or}~ n ~\textbf{mod}~ 4 = 2$}
	\STATE \textbf{return} nedá sa ohodnotiť
\ENDIF
\IF {$n = 7$}
	\STATE \textbf{return} $(1, 2, 4, 7), (3, 5, 6)$
\ENDIF
\IF {$n = 8$}
	\STATE \textbf{return} $(1, 4, 6, 7), (2, 3, 5, 8)$
\ENDIF
\IF {$n = 11$}
	\STATE \textbf{return} $(1, 3, 4, 5, 9, 11), (2, 6, 7, 8, 10)$
\ENDIF
\IF {$n = 12$}
	\STATE \textbf{return} $(1, 3, 7, 8, 9, 11), (2, 4, 5, 6, 10, 12)$
\ENDIF
\STATE $H \gets$ ohodnot(n - 8)
\FOR {$x \gets 1, 8$}
	\IF {$x \in \{1,4,6,7\}$}
		\STATE pridaj $(n-8)+x$ na ľavú stranu H
	\ELSE
		\STATE pridaj $(n-8)+x$ na pravú stranu H
	\ENDIF
\ENDFOR
\STATE \textbf{return} H
\end{algorithmic}

\subsection{Vrcholovo multiplikatívne magické grafy}

\begin{subalg} Na vstupe dostaneme kompletný bipartitný graf $K_{i,j}$. Výstupom má byť vrcholové multiplikatívne magické ohodnotenie tohto grafu. Algoritmus bude replikovať indukčný dôkaz vety 1.5.
\end{subalg}

\begin{algorithmic}
\IF {$i > j$}
	\STATE \textbf{return} ohodnot(j,i)
\ENDIF
\IF {$i \leq 1 ~\textbf{or}~ (i = 2 ~\textbf{and}~ j = 2)$}
	\STATE \textbf{return} nedá sa ohodnotiť
\ENDIF
\IF {$i = 2 ~\textbf{and}~ j = 3$}
	\STATE \textbf{return} $(5, 12), (1, 6, 10)$
\ENDIF
\IF {$i = 2 ~\textbf{and}~ j = 4$}
	\STATE \textbf{return} $(9, 16), (1, 2, 4, 18)$
\ENDIF
\IF {$i = 2$}
	\STATE \textbf{return} $((j-1)! + 1, (j-1)! ((j-1)! + 1 - \frac{j(j-1)}{2}), (1, ... , j-1, ((j-1)! + 1) ((j-1)! + 1 - \frac{j(j-1)}{2}))$
\ENDIF
\IF {$i = 3$}
	\STATE \textbf{return} $(1, j! + 1, j! (j! + 3 - \frac{j(j+1)}{2}), (2, ... , j, (j! + 1) (j! + 3 - \frac{j(j+1)}{2}))$
\ENDIF
\IF {$i = 4 ~\textbf{and}~ j = 4$}
	\STATE \textbf{return} $(1, 5, 6, 12), (2, 3, 4, 15)$
\ENDIF
\IF {$i = 4 ~\textbf{and}~ j = 5$}
	\STATE \textbf{return} $(2, 10, 20, 27), (1, 3, 6, 24, 25)$
\ENDIF
\STATE $H \gets$ ohodnot(i - 2, j - 3)
\STATE $x \gets$ max(H) + 1
\STATE $y \gets$ max(H) + 2
\STATE na ľavú stranu H pridaj $2xy, 2xy - x - y$
\STATE na pravú stranu H pridaj $2(2xy - x - y), x, y$
\STATE \textbf{return} H
\end{algorithmic}

\section{Magické obdĺžniky}

\subsection{Bimagické obdĺžniky}

\begin{subalg} Na vstupe dostaneme číslo $n,h \in \mathbb{N}, n \geq 4$. Výstupom má byť bimagický obdĺžnik veľkosti $3 \times n$, ktorého prvky sú kladné celé čísla neprevyšujúce $h$. Náš algoritmus predpokladá, že najmenší prvok obdĺžnika je $1$. Pre každú trojicu rôznych celých čísel $a,b,c$ väčších ako $1$ si predpočíta ich magický a bimagický súčet. Ak medzi súčtami platí istý vzťah, potom je možné nájsť celé čísla $d,e$ tak, aby mohli byť trojice $(a,b,c)$ a $(1,d,e)$ použité ako stĺpce v tom istom bimagickom obdĺžniku. Pre každú takú trojicu $(a,b,c)$ si algoritmus uloží hodnoty $(1,d,e)$ ako kľúč do asociatívneho poľa. Potom toto pole prejde a v každom kľúči vyberie $n-1$ rôznych zapamätaných trojíc (ku ktorým pridá trojicu v kľúči).
\end{subalg}

\begin{algorithmic}
\STATE $D = dict()$
\FOR {$a \gets 2, h$}
	\FOR {$b \gets a+1, h$}
		\FOR {$c \gets b+1, h$}
			\STATE $s \gets a+b+c$
			\STATE $t \gets a^2+b^2+c^2$
			\IF {$2t - (s-1)^2 - 2$ je štvorec}
				\STATE pridaj $(a,b,c)$ do $D[(1, \frac{s-1 + sqrt(2t - (s-1)^2 - 2)}{2}, \frac{s-1 - sqrt(2t - (s-1)^2 - 2)}{2})]$
			\ENDIF
		\ENDFOR
	\ENDFOR
\ENDFOR
\FORALL {$k \in D$}
	\FORALL {$(a_1, b_1, c_1), ... , (a_{n-1}, b_{n-1}, c_{n-1}) \in D[k]$}
		\IF  {$1, k[1], k[2], a_1, b_1, c_1, ... , a_{n-1}, b_{n-1}, c_{n-1}$ sú navzájom rôzne}
			\FORALL {permutácie $(a_i, b_i, c_i), i \in \{1, ... , n-1\}$}
				\STATE vytvor obdĺžnik s prvým stĺpcom $1, k[1], k[2]$ a $j$-tym stĺpcom $a_{j-1}, b_{j-1}, c_{j-1}$ pre $j \in \{2, ... n\}$
				\IF {obdĺžnik má bimagické riadky}
					\STATE \textbf{print}(obdlznik)
				\ENDIF
			\ENDFOR
		\ENDIF
	\ENDFOR
\ENDFOR
\end{algorithmic}

\begin{subalg} Na vstupe dostaneme čísla $n,s \in \mathbb{N}, n \geq 4$. Výstupom má byť bimagický obdĺžnik veľkosti $3 \times n$, ktorého prvky sú kladné celé čísla, pričom ich súčet v každom stĺpci je $s$. Náš algoritmus predpokladá, že najmenší prvok obdĺžnika je $1$. Pre každú trojicu rôznych celých čísel $a,b,c$ ($1 < a < b < c, a+b+c = s$) si predpočíta ich bimagický súčet. Ak platí istý vzťah, potom je možné nájsť celé čísla $d,e$ tak, aby mohli byť trojice $(a,b,c)$ a $(1,d,e)$ použité ako stĺpce v tom istom bimagickom obdĺžniku. Pre každú takú trojicu $(a,b,c)$ si algoritmus uloží hodnoty $(1,d,e)$ ako kľúč do asociatívneho poľa. Potom toto pole prejde a v každom kľúči vyberie $n-1$ rôznych zapamätaných trojíc (ku ktorým pridá trojicu v kľúči).
\end{subalg}

\begin{algorithmic}
\STATE $D = dict()$
\FOR {$a \gets 2, \ceil{\frac{s}{3}}$}
	\FOR {$b \gets a+1, \ceil{\frac{s-a}{2}}$}
		\STATE $c \gets s-a-b$
		\STATE $t \gets a^2+b^2+c^2$
		\STATE pokračuj rovnako ako predchádzajúci algoritmus
	\ENDFOR
\ENDFOR
\end{algorithmic}

\begin{subalg}: Na vstupe dostaneme číslo $n \in \mathbb{N}$. Výstupom má byť bimagický obdĺžnik veľkosti $3 \times n$, ktorého prvky sú celé (potenciálne záporné) čísla v absolútnej hodnote neprevyšujúce $h$. Náš algoritmus predpokladá, že bimagický obdĺžnik má v každom riadku aj stĺpci nulový súčet. Trojica prvkov v každom stĺpci je preto v tvare $a, b, -a-b$. Pre každú dvojicu celých čísel $a,b$ si algoritmus uloží hodnotu výrazu $a^2 + b^2 + (-a-b)^2$ ako kľúč do asociatívneho poľa. Potom toto pole prejde a v každom kľúči vyberie $n$ rôznych zapamätaných dvojíc.
\end{subalg}

\begin{algorithmic}
\STATE $D = dict()$
\FOR {$a \gets 0, h$}
	\FOR {$b \gets -a+1, a-1$}
		\STATE $t = a^2 + b^2 + (-a-b)^2$
		\STATE pridaj $(a,b)$ do $D[t]$
	\ENDFOR
\ENDFOR
\FORALL {$k \in D$}
	\FORALL {$(a_1, b_1), ... , (a_n, b_n) \in D[k]$}
		\IF  {$a_1, b_1, - a_1 - b_1, ... , a_n, b_n, - a_n - b_n$ sú navzájom rôzne}
			\FORALL {permutácie $(a_i, b_i, - a_i - b_i), i \in \{2, ... , n\}$}
				\STATE vytvor obdĺžnik s $j$-tym stĺpcom $a_j, b_j, - a_j - b_j$ pre $j \in \{1, ... n\}$
				\IF {obdĺžnik má bimagické riadky}
					\STATE \textbf{print}(obdlznik)
				\ENDIF
			\ENDFOR
		\ENDIF
	\ENDFOR
\ENDFOR
\end{algorithmic}


\subsection{Multiplikatívne magické obdĺžniky}

\begin{subalg}: Na vstupe dostaneme čísla $n,h \in \mathbb{N}, n \geq 4$. Výstupom má byť multiplikatívny magický obdĺžnik veľkosti $3 \times n$, ktorého prvky sú kladné celé čísla neprevyšujúce $h$. Vieme, že obdĺžnik nemôže obsahovať prvočíslo $p$, pre ktoré platí $pn > h$ (inak by sme mali nanajvýš $n-1$ násobkov $p$, ktoré by sme museli vedieť rozdeliť do $n$ stĺpcov, čo je spor). Náš algoritmus si pre každú trojicu vyhovujúcich rôznych kladných čísel predpočíta ich súčet a súčin a obe hodnoty si uloží ako kľúč do asociatívneho poľa. Potom toto pole prejde a v každom kľúči vyberie $n$ rôznych zapamätaných trojíc.
\end{subalg}

\begin{algorithmic}
\STATE $D = dict()$
\STATE $vyhovuju = \{x ~|~ x \in \{1, ... , h\}, x$ nie je prvočíslo alebo $xn \leq h\}$
\FORALL {$a,b,c \in vyhovuju; a < b < c$}
	\STATE $s \gets a+b+c$
	\STATE $p \gets abc$
	\STATE pridaj $(a,b,c)$ do $D[(s,p)]$
\ENDFOR
\FORALL {$k \in D$}
	\FORALL {$(a_1, b_1, c_1), ... , (a_n, b_n, c_n) \in D[k]$}
		\IF  {$a_1, b_1, c_1, ... , a_n, b_n, c_n$ sú navzájom rôzne}
			\FORALL {permutácie $(a_i, b_i, c_i), i \in \{2, ... , n\}$}
				\STATE vytvor obdĺžnik s $j$-tym stĺpcom $a_{j}, b_{j}, c_{j}$ pre $j \in \{1, ... n\}$
				\IF {obdĺžnik má multiplikatívne magické riadky}
					\STATE \textbf{print}(obdlznik)
				\ENDIF
			\ENDFOR
		\ENDIF
	\ENDFOR
\ENDFOR
\end{algorithmic}

\begin{subalg}: Na vstupe dostaneme čísla $n,s \in \mathbb{N}, n \geq 4$. Výstupom má byť multiplikatívny magický obdĺžnik veľkosti $3 \times n$, ktorého prvky sú kladné celé čísla, pričom ich súčet v každom stĺpci je $s$. Vieme, že obdĺžnik nemôže obsahovať prvočíslo $p$, pre ktoré platí $pn > s$. Náš algoritmus si pre každú trojicu vyhovujúcich rôznych kladných čísel si ich súčin uloží ako kľúč do asociatívneho poľa. Potom toto pole prejde a v každom kľúči vyberie $n$ rôznych zapamätaných trojíc.
\end{subalg}

\begin{algorithmic}
\STATE $D = dict()$
\STATE $vyhovuju = \{x ~|~ x \in \{1, ... , s\}, x$ nie je prvočíslo alebo $xn \leq s\}$
\FORALL {$a,b \in vyhovuju; a < b; a + 2b < s$}
	\STATE $c = s-a-b$
	\IF {$c \in vyhovuju$}
		\STATE $p = abc$
		\STATE pridaj $(a,b,c)$ do $D[p]$ \\
	\ENDIF
\ENDFOR
pokračuj rovnako ako predchádzajúci algoritmus
\end{algorithmic}

\begin{subnote} Algoritmy pre multiplikatívne magické obdĺžniky sa dajú obmedziť tak, aby dovoľovali iba konečný počet prvočísel v prvočíselnom rozklade.
\end{subnote} 

